<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.broadvideo.pixsignage.persistence.CoursescheduleMapper" >
  <resultMap id="BaseResultMap" type="com.broadvideo.pixsignage.domain.Courseschedule" >
    <id column="coursescheduleid" property="coursescheduleid" jdbcType="INTEGER" />
    <result column="courseid" property="courseid" jdbcType="INTEGER" />
    <result column="coursename" property="coursename" jdbcType="VARCHAR" />
    <result column="classroomid" property="classroomid" jdbcType="INTEGER" />
    <result column="classroomname" property="classroomname" jdbcType="VARCHAR" />
    <result column="teacherid" property="teacherid" jdbcType="INTEGER" />
    <result column="teachername" property="teachername" jdbcType="VARCHAR" />
    <result column="coursescheduleschemeid" property="coursescheduleschemeid" jdbcType="INTEGER" />
    <result column="workday" property="workday" jdbcType="INTEGER" />
    <result column="periodtimedtlid" property="periodtimedtlid" jdbcType="INTEGER" />
    <result column="orgid" property="orgid" jdbcType="INTEGER" />
    <result column="createtime" property="createtime" jdbcType="TIMESTAMP" />
    <result column="createpsnid" property="createpsnid" jdbcType="INTEGER" />
    <result column="updatetime" property="updatetime" jdbcType="TIMESTAMP" />
    <result column="updatepsnid" property="updatepsnid" jdbcType="INTEGER" />
    <association property="periodtimedtl" column="periodtimedtlid"  select="com.broadvideo.pixsignage.persistence.PeriodtimedtlMapper.selectByPrimaryKey" />
   
  </resultMap>
  <sql id="Base_Column_List" >
    coursescheduleid, courseid, coursename, classroomid, classroomname, teacherid, teachername, 
    coursescheduleschemeid, workday, periodtimedtlid, orgid, createtime, createpsnid, 
    updatetime, updatepsnid
  </sql>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.Integer" >
    select 
    <include refid="Base_Column_List" />
    from courseschedule
    where coursescheduleid = #{coursescheduleid,jdbcType=INTEGER}
  </select>
  <select  id="countBy"  resultType="Integer">
    select  
        count(1)
    from courseschedule
    where orgid=#{orgid}
    <if test="classroomid != null" >
      and  classroomid=#{classroomid}
    </if>
     <if test="periodtimedtlid != null" >
      and  periodtimedtlid=#{periodtimedtlid}
    </if>
    <if test="workday != null" >
      and  workday=#{workday}
    </if>

    
  
  </select>
  <select  id="selectClassroomCourseschedules"  resultMap="BaseResultMap">
   select  
      <include refid="Base_Column_List"/>
   from  courseschedule
   where classroomid=#{classroomid} and coursescheduleschemeid=#{coursescheduleschemeid} and orgid=#{orgid}
  
  </select>
  
  <select id="selectCourseschedule"  resultMap="BaseResultMap">
   select  
      <include refid="Base_Column_List"/>
   from  courseschedule
   where   coursescheduleid=#{coursescheduleid}  and orgid=#{orgid}
  
  </select>
  <select id="selectCurCourseschedule"  resultMap="BaseResultMap">
  select 
    cs.*
  from courseschedule cs
  left join periodtimedtl dtl
  on ( cs.coursescheduleschemeid=#{coursescheduleschemeid} and cs.classroomid=#{classroomid} and cs.periodtimedtlid = dtl.periodtimedtlid )
  where cs.orgid=#{orgid} and cs.workday=#{workday} and  #{curshorttime} >= dtl.shortstarttime and #{curshorttime} <![CDATA[<=]]> dtl.shortendtime
  </select>
  
  <delete id="deleteByPrimaryKey" parameterType="java.lang.Integer" >
    delete from courseschedule
    where coursescheduleid = #{coursescheduleid,jdbcType=INTEGER}
  </delete>
  <delete id="deleteCourseSchedule" >
    delete from courseschedule 
    where  coursescheduleid=#{coursescheduleid} and orgid=#{orgid}
  </delete>
  <delete id="batchDeleteCourseschedules">
   delete from courseschedule
   where orgid=#{orgid} and coursescheduleid in 
   <foreach close=")" collection="coursescheduleids" item="coursescheduleid" open="(" separator=",">
      #{coursescheduleid}
   </foreach>
  </delete>
  <delete id="deleteClassroomCourseschedules">
    delete from  courseschedule
    where orgid=#{orgid}  and classroomid in 
      <foreach close=")" collection="classroomids" item="classroomid" open="(" separator=",">
         #{classroomid}
      </foreach>
  </delete>
  <insert id="insert" parameterType="com.broadvideo.pixsignage.domain.Courseschedule" >
    <selectKey resultType="java.lang.Integer" keyProperty="coursescheduleid" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into courseschedule (courseid, coursename, classroomid, 
      classroomname, teacherid, teachername, 
      coursescheduleschemeid, workday, periodtimedtlid, 
      orgid, createtime, createpsnid, 
      updatetime, updatepsnid)
    values (#{courseid,jdbcType=INTEGER}, #{coursename,jdbcType=VARCHAR}, #{classroomid,jdbcType=INTEGER}, 
      #{classroomname,jdbcType=VARCHAR}, #{teacherid,jdbcType=INTEGER}, #{teachername,jdbcType=VARCHAR}, 
      #{coursescheduleschemeid,jdbcType=INTEGER}, #{workday,jdbcType=INTEGER}, #{periodtimedtlid,jdbcType=INTEGER}, 
      #{orgid,jdbcType=INTEGER}, #{createtime,jdbcType=TIMESTAMP}, #{createpsnid,jdbcType=INTEGER}, 
      #{updatetime,jdbcType=TIMESTAMP}, #{updatepsnid,jdbcType=INTEGER})
  </insert>
  <insert id="insertSelective" parameterType="com.broadvideo.pixsignage.domain.Courseschedule" >
    <selectKey resultType="java.lang.Integer" keyProperty="coursescheduleid" order="AFTER" >
      SELECT LAST_INSERT_ID()
    </selectKey>
    insert into courseschedule
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="courseid != null" >
        courseid,
      </if>
      <if test="coursename != null" >
        coursename,
      </if>
      <if test="classroomid != null" >
        classroomid,
      </if>
      <if test="classroomname != null" >
        classroomname,
      </if>
      <if test="teacherid != null" >
        teacherid,
      </if>
      <if test="teachername != null" >
        teachername,
      </if>
      <if test="coursescheduleschemeid != null" >
        coursescheduleschemeid,
      </if>
      <if test="workday != null" >
        workday,
      </if>
      <if test="periodtimedtlid != null" >
        periodtimedtlid,
      </if>
      <if test="orgid != null" >
        orgid,
      </if>
      <if test="createtime != null" >
        createtime,
      </if>
      <if test="createpsnid != null" >
        createpsnid,
      </if>
      <if test="updatetime != null" >
        updatetime,
      </if>
      <if test="updatepsnid != null" >
        updatepsnid,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="courseid != null" >
        #{courseid,jdbcType=INTEGER},
      </if>
      <if test="coursename != null" >
        #{coursename,jdbcType=VARCHAR},
      </if>
      <if test="classroomid != null" >
        #{classroomid,jdbcType=INTEGER},
      </if>
      <if test="classroomname != null" >
        #{classroomname,jdbcType=VARCHAR},
      </if>
      <if test="teacherid != null" >
        #{teacherid,jdbcType=INTEGER},
      </if>
      <if test="teachername != null" >
        #{teachername,jdbcType=VARCHAR},
      </if>
      <if test="coursescheduleschemeid != null" >
        #{coursescheduleschemeid,jdbcType=INTEGER},
      </if>
      <if test="workday != null" >
        #{workday,jdbcType=INTEGER},
      </if>
      <if test="periodtimedtlid != null" >
        #{periodtimedtlid,jdbcType=INTEGER},
      </if>
      <if test="orgid != null" >
        #{orgid,jdbcType=INTEGER},
      </if>
      <if test="createtime != null" >
        #{createtime,jdbcType=TIMESTAMP},
      </if>
      <if test="createpsnid != null" >
        #{createpsnid,jdbcType=INTEGER},
      </if>
      <if test="updatetime != null" >
        #{updatetime,jdbcType=TIMESTAMP},
      </if>
      <if test="updatepsnid != null" >
        #{updatepsnid,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <update id="updateByPrimaryKeySelective" parameterType="com.broadvideo.pixsignage.domain.Courseschedule" >
    update courseschedule
    <set >
      <if test="courseid != null" >
        courseid = #{courseid,jdbcType=INTEGER},
      </if>
      <if test="coursename != null" >
        coursename = #{coursename,jdbcType=VARCHAR},
      </if>
      <if test="classroomid != null" >
        classroomid = #{classroomid,jdbcType=INTEGER},
      </if>
      <if test="classroomname != null" >
        classroomname = #{classroomname,jdbcType=VARCHAR},
      </if>
      <if test="teacherid != null" >
        teacherid = #{teacherid,jdbcType=INTEGER},
      </if>
      <if test="teachername != null" >
        teachername = #{teachername,jdbcType=VARCHAR},
      </if>
      <if test="coursescheduleschemeid != null" >
        coursescheduleschemeid = #{coursescheduleschemeid,jdbcType=INTEGER},
      </if>
      <if test="workday != null" >
        workday = #{workday,jdbcType=INTEGER},
      </if>
      <if test="periodtimedtlid != null" >
        periodtimedtlid = #{periodtimedtlid,jdbcType=INTEGER},
      </if>
      <if test="orgid != null" >
        orgid = #{orgid,jdbcType=INTEGER},
      </if>
      <if test="createtime != null" >
        createtime = #{createtime,jdbcType=TIMESTAMP},
      </if>
      <if test="createpsnid != null" >
        createpsnid = #{createpsnid,jdbcType=INTEGER},
      </if>
      <if test="updatetime != null" >
        updatetime = #{updatetime,jdbcType=TIMESTAMP},
      </if>
      <if test="updatepsnid != null" >
        updatepsnid = #{updatepsnid,jdbcType=INTEGER},
      </if>
    </set>
    where coursescheduleid = #{coursescheduleid,jdbcType=INTEGER}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.broadvideo.pixsignage.domain.Courseschedule" >
    update courseschedule
    set courseid = #{courseid,jdbcType=INTEGER},
      coursename = #{coursename,jdbcType=VARCHAR},
      classroomid = #{classroomid,jdbcType=INTEGER},
      classroomname = #{classroomname,jdbcType=VARCHAR},
      teacherid = #{teacherid,jdbcType=INTEGER},
      teachername = #{teachername,jdbcType=VARCHAR},
      coursescheduleschemeid = #{coursescheduleschemeid,jdbcType=INTEGER},
      workday = #{workday,jdbcType=INTEGER},
      periodtimedtlid = #{periodtimedtlid,jdbcType=INTEGER},
      orgid = #{orgid,jdbcType=INTEGER},
      createtime = #{createtime,jdbcType=TIMESTAMP},
      createpsnid = #{createpsnid,jdbcType=INTEGER},
      updatetime = #{updatetime,jdbcType=TIMESTAMP},
      updatepsnid = #{updatepsnid,jdbcType=INTEGER}
    where coursescheduleid = #{coursescheduleid,jdbcType=INTEGER}
  </update>
</mapper>