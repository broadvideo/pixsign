{"version":3,"sources":["index.js"],"names":[],"mappings":"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","file":"index.js","sourcesContent":["'use strict';var Attendance=function(f,c){this.zonediv=f,this.zone=c,this.currentEvent=null,common.attendance.push(this);var a=0,g=function(b){if(b.id){$('.attendance-item').each(function(c,d){$(d).data('id')==b.id&&($(d).find('img').removeClass('opacity'),$(d).addClass('rubberBand'),setTimeout(function(){$(d).removeClass('rubberBand')},1e3))}),$('.attendance-popup').remove();var c=doT.template('<div class=\"attendance-popup animated\" data-id=\"{{=it.id}}\">\\n                <div class=\"attendance-popup-avatar\">\\n                    <img src=\"{{=it.avatar}}\"/>\\n                </div>\\n                <div class=\"attendance-popup-info\">\\n                    <p>\\u7B7E\\u5230\\u65F6\\u95F4\\uFF1A{{=moment().format(\\'HH:mm:ss\\')}}</p>\\n                </div>\\n            </div>');$('body').append(c(b)),clearTimeout(a),a=setTimeout(function(){$('.attendance-popup').remove()},5e3)}};this.refreshAttendance=function(){var f=this,c=Date.now(),a=common.attendanceEvents.filter(function(b){return b.start_time<c});0<a.length?(f.currentEvent=a[a.length-1],$.ajax({url:common.baseUrl+'/classrooms/'+common.classRoom.id+'/attendancesummary?event_id='+f.currentEvent.id,dataType:'json'}).then(function(b){console.log('get attendancesummary',b);var d=doT.template('<div class=\"attendance-summary\">\\n            <h3 class=\"title\">{{=it.event_name}}</h3>\\n            <p class=\"info\">\\u5E94\\u5230\\u4EBA\\u6570&nbsp;{{=it.total}}</p>\\n            <p class=\"info\">\\u5DF2\\u5230&nbsp;{{=it.avail_total}}</p>\\n        </div>');if($(f.zonediv).html(d(b.data)),$('#attendanceList').remove(),c<f.currentEvent.end_time){var d=doT.template('<div class=\"attendance-list\" id=\"attendanceList\">\\n            {{~it:student:index}}\\n            <div class=\"attendance-item animated\" data-id=\"{{=student.student_id}}\">\\n                <div class=\"attendance-avatar\">\\n                    <img src=\"{{=student.avatar}}\" {{?student.state == \\'2\\'}}class=\"opacity\"{{?}}/>\\n                </div>\\n                <div class=\"attendance-info\">\\n                    <p>{{=student.student_name}}</p>\\n                </div>\\n            </div>\\n            {{~}}\\n        </div>');$('body').append(d(b.data.dtls))}}).catch(function(b){console.log(b.message)})):this.zonediv.html('<div class=\"attendance-summary\">\\n            <p>\\u5F53\\u524D\\u65E0\\u8003\\u52E4</p>\\n        </div>')},this.init=function(){var b=this;setInterval(b.refreshAttendance,3e5),b.refreshAttendance()},this.resize=function(b){f.css({\"box-sizing\":'border-box',\"border-color\":c.bdcolor,\"border-style\":c.bdstyle,\"border-width\":parseInt(c.bdwidth)/b+'px',\"border-radius\":parseInt(c.bdradius)/b+'px',color:c.color,\"font-family\":c.fontfamily,\"font-size\":parseInt(c.fontsize)/b+'px',\"text-align\":c.align,\"font-weight\":c.fontweight,\"font-style\":c.fontstyle,overflow:'auto'})},this.swipe=function(c){var e=this;if(e.currentEvent&&e.currentEvent.end_time>Date.now()){var d=common.students.find(function(a){return a.hard_id==c});if(d){g(d);var a=JSON.stringify({event_id:e.currentEvent.id,hard_id:d.hard_id,student_id:d.id,classroom_id:common.classRoom.id,ts:Date.now()});$.ajax({url:common.baseUrl+'/students/'+d.id+'/attendance?event_time='+Date.now(),type:'post',contentType:'application/json',data:a}).then(function(){setTimeout(e.refreshAttendance,1e3)}).catch(function(b){console.log(JSON.stringify(b))})}}}};\n\n//# sourceMappingURL=index.js.map"]}