'use strict';var WeeklyCourse=function(a,f,d,e){this.zonediv=a,this.zone=f,common.weeklyCourse.push(this),this.resize=function(d){var c=Math.ceil,e=this;a.css({"box-sizing":'border-box',"border-color":f.bdcolor,"border-style":f.bdstyle,"border-width":parseInt(f.bdwidth)/d+'px',"border-radius":parseInt(f.bdradius)/d+'px',color:f.color,"font-family":f.fontfamily,"font-size":parseInt(f.fontsize)/d+'px',"text-align":f.align,"font-weight":f.fontweight,"font-style":f.fontstyle}),a.find('table').css({"table-layout":'fixed'}),a.find('td').css({"border-width":c(f.rulewidth/d)+'px',"border-color":f.rulecolor,"word-wrap":'break-word',"white-space":'pre-wrap',"text-decoration":f.decoration,height:e.zonediv.height()/f.rows-c(f.rulewidth/d)})},this.init=function(){var g=this;$.ajax({url:common.baseUrl+'/classrooms/'+common.classRoom.id+'/schedules?ts='+Date.now(),contentType:'application/json; charset=UTF-8',dataType:'json'}).then(function(b){if(0!=b.retcode)throw new Error('failed to get day course list.');b.course_schedules.forEach(function(a){a.current=moment().format('E')==a.workday&&moment(a.start_time,'HH:mm').isBefore(moment())&&moment(a.end_time,'HH:mm').isAfter(moment())}),b.scheme.workdays=b.scheme.workdays.map(function(a){return 1===a?{index:a,dayname:'\u661F\u671F\u4E00'}:2===a?{index:a,dayname:'\u661F\u671F\u4E8C'}:3===a?{index:a,dayname:'\u661F\u671F\u4E09'}:4===a?{index:a,dayname:'\u661F\u671F\u56DB'}:5===a?{index:a,dayname:'\u661F\u671F\u4E94'}:6===a?{index:a,dayname:'\u661F\u671F\u516D'}:7===a?{index:a,dayname:'\u661F\u671F\u5929'}:void 0}).slice(0,g.zone.cols-1),b.scheme.morning.dtls.forEach(function(a){switch(a.period_num){case 1:a.courseName='\u7B2C\u4E00\u8282';break;case 2:a.courseName='\u7B2C\u4E8C\u8282';break;case 3:a.courseName='\u7B2C\u4E09\u8282';break;case 4:a.courseName='\u7B2C\u56DB\u8282';}}),b.scheme.afternoon.dtls.forEach(function(a){switch(a.period_num){case 1:a.courseName='\u7B2C\u4E00\u8282';break;case 2:a.courseName='\u7B2C\u4E8C\u8282';break;case 3:a.courseName='\u7B2C\u4E09\u8282';break;case 4:a.courseName='\u7B2C\u56DB\u8282';}}),b.scheme.night.dtls.forEach(function(a){switch(a.period_num){case 1:a.courseName='\u7B2C\u4E00\u8282';break;case 2:a.courseName='\u7B2C\u4E8C\u8282';break;case 3:a.courseName='\u7B2C\u4E09\u8282';break;case 4:a.courseName='\u7B2C\u56DB\u8282';}}),b.cols=g.zone.cols;var c=doT.template('<table>\n            <tbody>\n            <tr>\n                <td>\u65F6\u95F4</td>\n                {{~it.scheme.workdays:day:index}}\n                <td>{{=day.dayname}}</td>\n                {{~}}\n            </tr>\n            {{~it.scheme.morning.dtls:courseIndex:index}}\n            <tr>\n                <td><span>{{=courseIndex.courseName}}</span><span>{{=courseIndex.start_time}}</span></td>\n                {{~it.scheme.workdays:day:index2}}\n                <td data-periodnum="{{=index+1}}" data-type="0" data-workday="{{=index2+1}}"> </td>\n                {{~}}\n            </tr>\n            {{~}}\n            <tr><td colspan="{{=it.cols}}"> </td></tr>\n            {{~it.scheme.afternoon.dtls:courseIndex:index}}\n            <tr>\n                <td><span>{{=courseIndex.courseName}}</span><span>{{=courseIndex.start_time}}</span></td>\n                {{~it.scheme.workdays:day:index2}}\n                <td data-periodnum="{{=index+1}}" data-type="2" data-workday="{{=index2+1}}"> </td>\n                {{~}}\n            </tr>\n            {{~}}\n            <tr></tr>\n            {{~it.scheme.night.dtls:courseIndex:index}}\n            <tr>\n                <td><span>{{=courseIndex.courseName}}</span><span>{{=courseIndex.start_time}}</span></td>\n                {{~it.scheme.workdays:day:index2}}\n                <td data-periodnum="{{=index+1}}" data-type="3" data-workday="{{=index2+1}}"> </td>\n                {{~}}\n            </tr>\n            {{~}}\n            </tbody>\n        </table>');g.zonediv.html(c(b)),b.course_schedules.forEach(function(d){g.zonediv.find('td').each(function(a,b){$(b).data('periodnum')==d.period_num&&$(b).data('type')==d.type&&$(b).data('workday')==d.workday&&$(b).html('<span>'+d.course_name+'</span>&nbsp;<span>('+d.teacher_name+')</span>')})}),g.zonediv.find('tr').each(function(a,b){a>=g.zone.rows&&$(b).remove()}),g.zonediv.find('table').css({width:'100%',height:'100%'}),g.zonediv.find('table').attr('rules',g.zone.rules),g.resize(d,e)}).catch(function(a){console.log(a.message)})}};

//# sourceMappingURL=index.js.map