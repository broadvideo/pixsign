'use strict';var WeeklyCourse=function(a,b,c,d){this.zonediv=a,this.zone=b;var e=window.android&&window.android.getHost()||'192.168.0.71',f='http://'+e+'/pixsignage-api/service',g=window.android&&window.android.getTerminalId()||'00004',h={},i=moment();$.ajaxSetup({global:!0,cache:!1});this.resize=function(c){var d=Math.ceil,e=this;a.css({"box-sizing":'border-box',"border-color":b.bdcolor,"border-style":b.bdstyle,"border-width":parseInt(b.bdwidth)/c+'px',"border-radius":parseInt(b.bdradius)/c+'px',color:b.color,"font-family":b.fontfamily,"font-size":parseInt(b.fontsize)/c+'px',"text-align":b.align,"font-weight":b.fontweight,"font-style":b.fontstyle}),a.find('table').css({"table-layout":'fixed'}),a.find('td').css({"border-width":d(b.rulewidth/c)+'px',"border-color":b.rulecolor,"word-wrap":'break-word',"white-space":'pre-wrap',"text-decoration":b.decoration,height:e.zonediv.height()/b.rows-d(b.rulewidth/c)})},this.init=function(){var a=this;$.ajax({url:f+'/terminals/'+g+'/classroom',dataType:'json'}).then(function(a){return h=a.classroom,$.ajax({url:f+'/classrooms/'+h.id+'/schedules',contentType:'application/json; charset=UTF-8',dataType:'json'})}).then(function(b){if(0!=b.retcode)throw new Error('failed to get day course list.');b.course_schedules.forEach(function(a){a.current=moment().format('E')==a.workday&&moment(a.start_time,'HH:mm').isBefore(moment())&&moment(a.end_time,'HH:mm').isAfter(moment())}),b.scheme.workdays=b.scheme.workdays.map(function(a){return 1===a?{index:a,dayname:'\u661F\u671F\u4E00'}:2===a?{index:a,dayname:'\u661F\u671F\u4E8C'}:3===a?{index:a,dayname:'\u661F\u671F\u4E09'}:4===a?{index:a,dayname:'\u661F\u671F\u56DB'}:5===a?{index:a,dayname:'\u661F\u671F\u4E94'}:6===a?{index:a,dayname:'\u661F\u671F\u516D'}:7===a?{index:a,dayname:'\u661F\u671F\u5929'}:void 0}).slice(0,a.zone.cols-1),b.scheme.morning.dtls.forEach(function(a){switch(a.period_num){case 1:a.courseName='\u7B2C\u4E00\u8282';break;case 2:a.courseName='\u7B2C\u4E8C\u8282';break;case 3:a.courseName='\u7B2C\u4E09\u8282';break;case 4:a.courseName='\u7B2C\u56DB\u8282';}}),b.scheme.afternoon.dtls.forEach(function(a){switch(a.period_num){case 1:a.courseName='\u7B2C\u4E00\u8282';break;case 2:a.courseName='\u7B2C\u4E8C\u8282';break;case 3:a.courseName='\u7B2C\u4E09\u8282';break;case 4:a.courseName='\u7B2C\u56DB\u8282';}}),b.scheme.night.dtls.forEach(function(a){switch(a.period_num){case 1:a.courseName='\u7B2C\u4E00\u8282';break;case 2:a.courseName='\u7B2C\u4E8C\u8282';break;case 3:a.courseName='\u7B2C\u4E09\u8282';break;case 4:a.courseName='\u7B2C\u56DB\u8282';}}),b.cols=a.zone.cols;var e=doT.template('<table>\n            <tbody>\n            <tr>\n                <td>\u65F6\u95F4</td>\n                {{~it.scheme.workdays:day:index}}\n                <td>{{=day.dayname}}</td>\n                {{~}}\n            </tr>\n            {{~it.scheme.morning.dtls:courseIndex:index}}\n            <tr>\n                <td><span>{{=courseIndex.courseName}}</span><span>{{=courseIndex.start_time}}</span></td>\n                {{~it.scheme.workdays:day:index2}}\n                <td data-periodnum="{{=index}}" data-type="0" data-workday="{{=index2}}"> </td>\n                {{~}}\n            </tr>\n            {{~}}\n            <tr><td colspan="{{=it.cols}}"> </td></tr>\n            {{~it.scheme.afternoon.dtls:courseIndex:index}}\n            <tr>\n                <td><span>{{=courseIndex.courseName}}</span><span>{{=courseIndex.start_time}}</span></td>\n                {{~it.scheme.workdays:day:index2}}\n                <td data-periodnum="{{=index}}" data-type="2" data-workday="{{=index2}}"> </td>\n                {{~}}\n            </tr>\n            {{~}}\n            <tr></tr>\n            {{~it.scheme.night.dtls:courseIndex:index}}\n            <tr>\n                <td><span>{{=courseIndex.courseName}}</span><span>{{=courseIndex.start_time}}</span></td>\n                {{~it.scheme.workdays:day:index2}}\n                <td data-periodnum="{{=index}}" data-type="3" data-workday="{{=index2}}"> </td>\n                {{~}}\n            </tr>\n            {{~}}\n            </tbody>\n        </table>');a.zonediv.html(e(b)),b.course_schedules.forEach(function(b){a.zonediv.find('td').each(function(a,c){$(c).data('periodnum')==b.period_num&&$(c).data('type')==b.type&&$(c).data('workday')==b.workday&&$(c).html('<span>'+b.course_name+'</span><span>('+b.teacher_name+')</span>')})}),a.zonediv.find('tr').each(function(b,c){b>=a.zone.rows&&$(c).remove()}),a.zonediv.find('table').css({width:'100%',height:'100%'}),a.zonediv.find('table').attr('rules',a.zone.rules),a.resize(c,d)}).catch(function(a){console.log(a.message)})},this.init()};

//# sourceMappingURL=index.js.map