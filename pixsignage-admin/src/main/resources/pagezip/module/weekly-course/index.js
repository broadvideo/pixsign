'use strict';var WeeklyCourse=function(e,f,h,g){this.zonediv=e,this.zone=f,common.weeklyCourse.push(this),this.resize=function(a){var b=Math.ceil,c=this;e.css({"box-sizing":'border-box',"border-color":f.bdcolor,"border-style":f.bdstyle,"border-width":parseInt(f.bdwidth)/a+'px',"border-radius":parseInt(f.bdradius)/a+'px',color:f.color,"font-family":f.fontfamily,"font-size":parseInt(f.fontsize)/a+'px',"text-align":f.align,"font-weight":f.fontweight,"font-style":f.fontstyle}),e.find('table').css({"table-layout":'fixed'}),e.find('td').css({"border-width":b(f.rulewidth/a)+'px',"border-color":f.rulecolor,"word-wrap":'break-word',"white-space":'pre-wrap',"text-decoration":f.decoration,height:c.zonediv.height()/f.rows-b(f.rulewidth/a)})},this.init=function(){var c=this;$.ajax({url:common.baseUrl+'/classrooms/'+common.classRoom.id+'/schedules?ts='+Date.now(),contentType:'application/json; charset=UTF-8',dataType:'json'}).then(function(d){if(0!=d.retcode)throw new Error('failed to get day course list.');d.course_schedules.forEach(function(a){a.current=moment().format('E')==a.workday&&moment(a.start_time,'HH:mm').isBefore(moment())&&moment(a.end_time,'HH:mm').isAfter(moment())}),d.scheme.workdays=d.scheme.workdays.map(function(a){return 1===a?{index:a,dayname:'\u661F\u671F\u4E00'}:2===a?{index:a,dayname:'\u661F\u671F\u4E8C'}:3===a?{index:a,dayname:'\u661F\u671F\u4E09'}:4===a?{index:a,dayname:'\u661F\u671F\u56DB'}:5===a?{index:a,dayname:'\u661F\u671F\u4E94'}:6===a?{index:a,dayname:'\u661F\u671F\u516D'}:7===a?{index:a,dayname:'\u661F\u671F\u5929'}:void 0}).slice(0,c.zone.cols-1),d.scheme.morning.dtls.forEach(function(a){switch(a.period_num){case 1:a.courseName='\u7B2C\u4E00\u8282';break;case 2:a.courseName='\u7B2C\u4E8C\u8282';break;case 3:a.courseName='\u7B2C\u4E09\u8282';break;case 4:a.courseName='\u7B2C\u56DB\u8282';}}),d.scheme.afternoon.dtls.forEach(function(a){switch(a.period_num){case 1:a.courseName='\u7B2C\u4E00\u8282';break;case 2:a.courseName='\u7B2C\u4E8C\u8282';break;case 3:a.courseName='\u7B2C\u4E09\u8282';break;case 4:a.courseName='\u7B2C\u56DB\u8282';}}),d.scheme.night.dtls.forEach(function(a){switch(a.period_num){case 1:a.courseName='\u7B2C\u4E00\u8282';break;case 2:a.courseName='\u7B2C\u4E8C\u8282';break;case 3:a.courseName='\u7B2C\u4E09\u8282';break;case 4:a.courseName='\u7B2C\u56DB\u8282';}}),d.cols=c.zone.cols;var a=doT.template('<table>\n            <tbody>\n            <tr>\n                <td>\u65F6\u95F4</td>\n                {{~it.scheme.workdays:day:index}}\n                <td>{{=day.dayname}}</td>\n                {{~}}\n            </tr>\n            {{~it.scheme.morning.dtls:courseIndex:index}}\n            <tr>\n                <td><span>{{=courseIndex.courseName}}</span><span>{{=courseIndex.start_time}}</span></td>\n                {{~it.scheme.workdays:day:index2}}\n                <td data-periodnum="{{=index+1}}" data-type="0" data-workday="{{=index2+1}}"> </td>\n                {{~}}\n            </tr>\n            {{~}}\n            <tr><td colspan="{{=it.cols}}"> </td></tr>\n            {{~it.scheme.afternoon.dtls:courseIndex:index}}\n            <tr>\n                <td><span>{{=courseIndex.courseName}}</span><span>{{=courseIndex.start_time}}</span></td>\n                {{~it.scheme.workdays:day:index2}}\n                <td data-periodnum="{{=index+1}}" data-type="2" data-workday="{{=index2+1}}"> </td>\n                {{~}}\n            </tr>\n            {{~}}\n            <tr></tr>\n            {{~it.scheme.night.dtls:courseIndex:index}}\n            <tr>\n                <td><span>{{=courseIndex.courseName}}</span><span>{{=courseIndex.start_time}}</span></td>\n                {{~it.scheme.workdays:day:index2}}\n                <td data-periodnum="{{=index+1}}" data-type="3" data-workday="{{=index2+1}}"> </td>\n                {{~}}\n            </tr>\n            {{~}}\n            </tbody>\n        </table>');c.zonediv.html(a(d)),d.course_schedules.forEach(function(d){c.zonediv.find('td').each(function(c,b){$(b).data('periodnum')==d.period_num&&$(b).data('type')==d.type&&$(b).data('workday')==d.workday&&$(b).html('<span>'+d.course_name+'</span><span>('+d.teacher_name+')</span>')})}),c.zonediv.find('tr').each(function(d,a){d>=c.zone.rows&&$(a).remove()}),c.zonediv.find('table').css({width:'100%',height:'100%'}),c.zonediv.find('table').attr('rules',c.zone.rules),c.resize(h,g)}).catch(function(a){console.log(a.message)})}};

//# sourceMappingURL=index.js.map