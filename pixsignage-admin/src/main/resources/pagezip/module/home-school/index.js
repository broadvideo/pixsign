'use strict';var HomeSchool=function(e,a){this.zonediv=e,this.zone=a,common.homeSchool.push(this);var f={},g='<div class="home-school-popup">\n            <div style="padding: 0 5px;">\n                <span class="home-school-close"><i class="fa fa-times"></i></span>\n                <p class="home-school-title">\u6D88\u606F\u5217\u8868</p>\n            </div>\n            <hr style="margin: 0">\n            <table class="home-school-table">\n                <tbody>\n                {{~it:message:index}}\n                <tr class="home-school-tr">\n                    <td class="home-school-avatar">\n                        <img src="{{=message.headimgurl}}"/>\n                    </td>\n                    <td class="home-school-name">\n                        <span>{{=message.name}}</span>\n                    </td>\n                    <td class="home-school-message">\n                        {{? message.message_info}}\n                        <span>{{=message.message_info}}</span>\n                        {{?}}\n                        {{? message.mp3_file}}\n                        <audio src="{{=message.mp3_file}}" controls=controls></audio>\n                        {{?}}\n                    </td>\n                    <td class="home-school-ts">\n                        <span>{{=message.send_time}}</span>\n                    </td>\n                </tr>\n                {{~}}\n                </tbody>\n            </table>\n            <hr style="margin: 0">\n            <div style="padding:0 5px">\n                <span class="home-school-audio"><i class="fa fa-bullhorn"></i></span>\n            </div>\n        </div>';this.init=function(){$.ajax({url:common.baseUrl+'/classrooms/'+common.classRoom.id+'/messagesum?ts='+Date.now(),dataType:'text'}).then(function(e){console.log(JSON.stringify(e));var a=Base64.decode(e),f=JSON.parse(a);console.log(f),f.forEach(function(c){common.students.forEach(function(a){a.student_no===c.student_no&&(c.avatar=a.avatar)})});var c=doT.template('<table class="home-school-table">\n            <tbody>\n            {{~it:msgSum:index}}\n            <tr class="home-school-tr">\n                <td class="home-school-avatar">\n                    <img src="{{=msgSum.avatar}}"/>\n                </td>\n                <td class="home-school-name">\n                    <span>{{=msgSum.student_name}}</span>\n                </td>\n                <td class="home-school-ts">\n                    <span>{{=msgSum.num}}</span>\n                </td>\n            </tr>\n            {{~}}\n            </tbody>\n        </table>');$('.home-school').each(function(d,a){$(a).html(c(f))})}).catch(function(b){console.log(JSON.stringify(b))}),$('body').on('click','.home-school-close',function(){$('.home-school-popup').remove()}),$('body').on('click','.home-school-audio',function(c){if(c.preventDefault(),console.log('recording button is clicked'),$(this).hasClass('recording')){$(this).removeClass('recording');var a=window.android.closeVoiceRecorder(),e={student_id:f.id,text:'',audio:a,msg_time:Date.now()};$.ajax({url:common.baseUrl+'/students/'+f.id+'/message?ts='+Date.now(),type:'POST',cache:!1,data:JSON.stringify(e),contentType:'application/json',dataType:'json'}).then(function(){console.log('send message successfully')}).catch(function(b){console.log(JSON.stringify(b))})}else $(this).addClass('recording'),window.android.openVoiceRecorder()})},this.resize=function(b){e.css({"box-sizing":'border-box',"border-color":a.bdcolor,"border-style":a.bdstyle,"border-width":parseInt(a.bdwidth)/b+'px',"border-radius":parseInt(a.bdradius)/b+'px',color:a.color,"font-family":a.fontfamily,"font-size":parseInt(a.fontsize)/b+'px',"text-align":a.align,"font-weight":a.fontweight,"font-style":a.fontstyle})},this.swipe=function(c){var a=common.students.filter(function(a){return a.hard_id==c});a.length&&(f=a[0],$.ajax({url:common.baseUrl+'/students/'+f.id+'/messages?ts='+Date.now(),dataType:'text'}).then(function(d){var a=Base64.decode(d),b=JSON.parse(a);$('.home-school-popup').remove();var c=doT.template(g);$(document.body).append(c(b))}).catch(function(b){console.log(b)}))},this.keyup=function(){f=common.students[Math.floor(10*Math.random())],$.ajax({url:common.baseUrl+'/students/18/messages?ts='+Date.now(),dataType:'text'}).then(function(d){var a=Base64.decode(d),b=JSON.parse(a);console.log(b),$('.home-school-popup').remove();var c=doT.template(g);$(document.body).append(c(b))}).catch(function(b){console.log(b)})}};

//# sourceMappingURL=index.js.map