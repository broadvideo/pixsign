'use strict';var HomeSchool=function(){var a='<div style="padding: 0 5px;">\n            <span class="home-school-close"><i class="fa fa-times"></i></span>\n            <p class="home-school-title">\u6D88\u606F\u5217\u8868</p>\n        </div>\n        <hr style="margin: 0">\n        <table class="home-school-table">\n            <tbody>\n            {{~it:message:index}}\n            <tr class="home-school-tr">\n                <td class="home-school-avatar">\n                    <img src="{{=message.headimgurl}}"/>\n                </td>\n                <td class="home-school-name">\n                    <span>{{=message.name}}</span>\n                </td>\n                <td class="home-school-message">\n                    {{? message.message_info}}\n                    <span>{{=message.message_info}}</span>\n                    {{?}}\n                    {{? message.mp3_file}}\n                    <audio src="{{=message.mp3_file}}" controls=controls></audio>\n                    {{?}}\n                </td>\n                <td class="home-school-ts">\n                    <span>{{=message.send_time}}</span>\n                </td>\n            </tr>\n            {{~}}\n            </tbody>\n        </table>\n        <hr style="margin: 0">\n        <div style="padding:0 5px">\n            <span class="home-school-audio"><i class="fa fa-bullhorn"></i></span>\n        </div>',b=window.android&&window.android.getHost()||'192.168.0.102',c='http://'+b+'/pixsignage-api/service',d=window.android&&window.android.getTerminalId()||'00002',e={},f=[],g={};return{init:function init(){$.ajax({url:c+'/terminals/'+d+'/classroom',dataType:'json'}).then(function(a){return e=a.classroom,$.ajax({url:c+'/classrooms/'+e.id+'/students',dataType:'json'})}).then(function(a){return f=a.data,$.ajax({url:c+'/classrooms/'+e.id+'/messagesum',dataType:'text'})}).then(function(a){var b=Base64.decode(a),c=JSON.parse(b);console.log(c),c.forEach(function(a){f.forEach(function(b){b.student_no===a.student_no&&(a.avatar=b.avatar)})});var d=doT.template('<table class="home-school-table">\n            <tbody>\n            {{~it:msgSum:index}}\n            <tr class="home-school-tr">\n                <td class="home-school-avatar">\n                    <img src="{{=msgSum.avatar}}"/>\n                </td>\n                <td class="home-school-name">\n                    <span>{{=msgSum.student_name}}</span>\n                </td>\n                <td class="home-school-ts">\n                    <span>{{=msgSum.num}}</span>\n                </td>\n            </tr>\n            {{~}}\n            </tbody>\n        </table>');$('.home-school').each(function(a,b){$(b).html(d(c))})}).catch(function(a){console.log(a)}),$('body').on('click','.home-school-close',function(){$('.home-school-popup').remove()}),$('body').on('click','.home-school-audio',function(a){if(a.stopPropagation(),a.preventDefault(),$(this).hasClass('recording')){$(this).removeClass('recording');var b=window.android.closeVoiceRecorder();console.log(b)}else $(this).addClass('recording'),window.android.openVoiceRecorder()})},swipe:function swipe(b){var d=f.filter(function(a){return a.hard_id==b});d.length&&(g=d[0],$.ajax({url:c+'/students/'+g.id+'/messages',dataType:'text'}).then(function(b){var c=Base64.decode(b),d=JSON.parse(c);$('.home-school-popup').remove();var e=doT.template(a);$('<div />').addClass('home-school-popup').html(e(d)).appendTo('body')}).catch(function(a){console.log(a)}))},keyup:function keyup(){g=f[Math.floor(10*Math.random())],$.ajax({url:c+'/students/'+18+'/messages',dataType:'text'}).then(function(b){var c=Base64.decode(b),d=JSON.parse(c);console.log(d),$('.home-school-popup').remove();var e=doT.template(a);$('<div />').addClass('home-school-popup').html(e(d)).appendTo('body')}).catch(function(a){console.log(a)})}}}();document.body.addEventListener('keyup',HomeSchool.keyup);

//# sourceMappingURL=index.js.map